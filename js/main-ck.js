/*global L: true*//*global google: true*//*global TweenMax: true*//*jshint devel:true*/$(document).ready(function(){var e={s:{},init:function(){e.genSet();e.genMap();e.getJson()},genSet:function(){e.s.map=$("#map");e.s.regLoc={"my-location":["",""],auckland:[-36.85,174.7833],otago:[-45.4333,169.8333],christchurch:[-43.5,172.6],dunedin:[-45.89,170.5],hamilton:[-37.7833,175.2833],"hawkes-bay":[-39.4167,176.8167],canterbury:[-43.55,171.22],wellington:[-41.2889,174.7772]};e.s.pin={};e.s.pin.orgHgt=473;e.s.pin.orgWth=292;e.s.pin.smlRatio=.2;e.s.pin.lrgRatio=.35;e.s.pin.smlHgt=e.s.pin.orgHgt*e.s.pin.smlRatio;e.s.pin.smlWth=e.s.pin.orgWth*e.s.pin.smlRatio;e.s.pin.lrgHgt=e.s.pin.orgHgt*e.s.pin.lrgRatio;e.s.pin.lrgWth=e.s.pin.orgWth*e.s.pin.lrgRatio;e.s.phpData=["blank","blank"];e.s.uQ=$(".user-query");e.s.swpTxt=e.s.uQ.find(".swap-txt");e.s.pCity=e.s.uQ.find(".pick-city").find("ul");e.s.pCuis=e.s.uQ.find(".pick-cuisine").find("ul");e.s.whtOut=$(".white-out")},genMap:function(){console.log("generating map!");var t=L.mapbox.map("map","fairfax.map-2vlbm9o8");e.s.map=t},posMap:function(t){console.log("city array reference = "+t);var n=e.s.map,r=e.s.regLoc,i=r[t][0],s=r[t][1];console.log("");console.log("chised lat = "+i+" and lng = "+s);console.log("");n.setView([i,s],13)},getJson:function(){$.getJSON("js/restaurant-info.json",function(t){e.s.json=t}).success(function(){}).error(function(){}).complete(function(){console.log("got json");e.genIcon();e.listeners();e.geoLoc()})},genIcon:function(){console.log("generating icons!");var t=e.s.map,n=e.s.json,r=n.length,i=e.s.pin.smlHgt,s=e.s.pin.smlWth,o=e.s.pin.lrgHgt,u=null,a=null,f=null,l=null,c=null,h=null,p=null,d=null,v=null;console.log("json length = "+r);for(var m=0;m<r;m++){u=n[m].Latitude;a=n[m].Longitude;l=n[m].Description;c=n[m].Type;h=n[m].Address;p=n[m].Phone;d=n[m].Web;v=n[m].Hours;f=l+"<br>"+c+"<br>"+h+"<br>"+p+"<br>"+d+"<br>"+v;console.log("json latitude = "+u);console.log("json longitude = "+a);m%100===0?L.mapbox.markerLayer({type:"Feature",geometry:{type:"Point",coordinates:[a,u]},properties:{"marker-color":"#333333","marker-size":"large",title:"Silver Fern Farms Sponsorship...",description:f}}).addTo(t):L.mapbox.markerLayer({type:"Feature",geometry:{type:"Point",coordinates:[a,u]},properties:{"marker-color":"#129a5f","marker-size":"small",title:"Generic Restaurant",description:f}}).addTo(t)}},geoLoc:function(){if(google.loader.ClientLocation){var t=google.loader.ClientLocation;if(!t.latitude)return"";console.log("loc.latitude = "+t.latitude);console.log("loc.longitude = "+t.longitude);var n=e.s.regLoc,r=t.latitude,i=t.longitude,s=e.s.uQ,o=s.find(".pick-city").find(".swap-txt"),u=o.siblings("ul").find($('li[data-selection="my-location"]'));n["my-location"][0]=r;n["my-location"][1]=i;u.css({display:"block"});e.s.phpData=["blank","my-location"];o.text("my location")}},listeners:function(){console.log("generating listeners!");$(".leaflet-marker-icon").on("mouseenter",function(){e.uiAct.iconEnter($(this))});$(".leaflet-marker-icon").on("mouseleave",function(){e.uiAct.iconLeave($(this))});$(".leaflet-marker-icon").on("click",function(){e.uiAct.iconClick($(this))});e.s.uQ.on("click",".swap-txt",function(){e.uiAct.selClick($(this))});e.s.uQ.on("click","li",function(){e.uiAct.selLstClick($(this))})},uiAct:{iconEnter:function(t){console.log("icon enter!");var n=t.attr("src");console.log("image src = "+n);if(n!=="img/special-pin.png"){console.log("NOT SPECIAL PIN!");return""}var r=e.s.pin.lrgHgt,i=e.s.pin.lrgWth,s=e.s.pin.smlHgt,o=e.s.pin.smlWth,u=(r-s)*-1,a=(r-s)/2*-1;TweenMax.to(t,.25,{width:i,height:r,top:u,left:a+15})},iconLeave:function(t){console.log("icon leave!");var n=t.attr("src");console.log("image src = "+n);if(n!=="img/special-pin.png"||t.attr("data-active")==="true"){console.log("NOT SPECIAL PIN!");return""}var r=e.s.pin.smlHgt,i=e.s.pin.smlWth;TweenMax.to(t,.25,{width:i,height:r,top:"0",left:"0"})},iconClick:function(e){console.log("icon click!");var t=e.attr("src");console.log("image src = "+t);if(t!=="img/special-pin.png"){console.log("NOT SPECIAL PIN!");return""}var n=e.attr("data-active");n==="false"?e.attr({"data-active":"true"}):e.attr({"data-active":"false"})},selClick:function(t){console.log("selection click!");var n=t.closest(".selection").hasClass("pick-city"),r=null,i=null;if(n){r=e.s.pCity;i=e.s.pCuis}else{r=e.s.pCuis;i=e.s.pCity}TweenMax.to(e.s.whtOut,1,{opacity:"0.8",display:"block"});TweenMax.to(r,1,{display:"block",opacity:"1",left:"50%",transform:"translateX(-50%)",top:"60px"});TweenMax.set(i,{display:"none",opacity:"0",left:"0",transform:"translateX(-50%)",top:"0"})},selLstClick:function(t){console.log("selection list click!");var n=t.hasClass("close"),r=t.closest("ul");if(n){TweenMax.set(r,{display:"none",opacity:"0",left:"0",transform:"translateX(-50%)",top:"0"});return""}var i=t.text(),s=t.closest(".selection"),o=s.find(".swap-txt"),u=0,a=e.s.phpData;console.log("current selection text = "+o.text());console.log("list item text = "+i);o.text(i);s.hasClass("pick-city")&&(u=1);e.s.phpData[u]=t.attr("data-selection");console.log("cusine = "+e.s.phpData[0]+" | region = "+e.s.phpData[1]);TweenMax.set(r,{display:"none",opacity:"0",left:"0",transform:"translateX(-50%)",top:"0"});if(a[0]!=="blank"&&a[1]!=="blank"){console.log("POPULATE MAP!");e.posMap(a[1]);TweenMax.to(e.s.whtOut,1,{opacity:"0",display:"none"});TweenMax.to(e.s.uQ,1,{boxShadow:"0 20px 20px -20px #999999","font-size":"30px",left:"0",width:"100%",padding:"25px"})}}}};(function(){e.init()})()});